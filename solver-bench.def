Bootstrap: docker
From: debian:testing-slim

%environment
    export LC_ALL=C
    export LANG=C
    export PATH=/usr/local/bin:$PATH

%post
    set -euo pipefail
    apt-get update
    apt-get install -y --no-install-recommends \
        python3 python3-pip default-jre-headless libgmp10 ca-certificates \
        && rm -rf /var/lib/apt/lists/*

    # benchexec
    pip3 install --no-cache-dir --break-system-packages benchexec

    chmod 0755 /usr/local/bin/cvc5 /usr/local/bin/z3-noodler
    chmod 0644 /usr/local/bin/ostrich.jar /usr/local/bin/mas.jar
    printf '#!/bin/bash\nexec java -jar /usr/local/bin/ostrich.jar "$@"\n' >/usr/local/bin/ostrich
    chmod +x /usr/local/bin/ostrich
    printf '#!/bin/bash\nexec java -jar /usr/local/bin/mas.jar edu.boisestate.cs.SolveMain "$@"\n' >/usr/local/bin/mas
    chmod +x /usr/local/bin/mas

%files
    bin/cvc5 /usr/local/bin/cvc5
    bin/z3-noodler /usr/local/bin/z3-noodler
    bin/ostrich.jar /usr/local/bin/ostrich.jar
    bin/mas.jar /usr/local/bin/mas.jar

%labels
    Author="Nat Steven"
    Tooling="BenchExec+Solvers"